import hashlib

def xor(bin_str1, bin_str2):
    bin_xor = ''

    for i in range(len(bin_str1)):
        if bin_str1[i] == bin_str2[i]:
            bin_xor += '0'
        else:
            bin_xor += '1'

    return bin_xor


def hash(i):
    m = hashlib.sha256()
    m.update(int(i, 2).to_bytes(len(i), 'little'))
    return format(int(m.hexdigest(), 16), '0256b')


def HMAC(K,M):
    ipad = '00110110' * 8
    opad = '01011100' * 8

    ipad_k = xor(K, ipad)
    opad_k = xor(K, opad)

    new_msg = ipad_k + M
    hash1 = hash(new_msg)

    new_msg = opad_k + hash1
    hash2 = hash(new_msg)

    return hash2





if __name__ == '__main__':
    hmac = '1010011101011000110010101011100100001001110111010000110100110111001001110010001101001010000011010001001101010100000010100111110010101011001101001010101100110110000101101110100000010001101011011011110011110111011100110000011010110001110000011000011100101001'
    msg_enc1 = '0110011010100110101010011000011111010000110111011011110110110101'
    msg_enc2 = '0110011010100110101010011000011111010000110111010011110110110101'
    key = '0001101100001110010010101101001101101010000100100000100001101100'

    print(HMAC('0010111000111100100000001100001000110000100011001110011110010000',
               '0100011001010010011011010100100100011101011101111011010000101010')
          == '1101011010010010001001010001100000001011000100001100101110111010000001000000110000001111011111110101011101111010110111001111001001001010000011110101110101010000100011110100101000111001000111000011111000011111001001110000110001111100110011110010100110000100')
    print(HMAC('1000110000100011001111011101000000010001110101110011101011000110',
               '1100110101011010110010110011001001010000000000111000011011000011')
          == '0100010101000110011101000100111010101111011110001010001001011000010001011100010100000000010010110000100010010101011011000010111000001110000101100011101100111111001000101101110011101100001111000000011111011111100001010111010011010010101100010101011100111010')
    print(HMAC('0010100101111010101111100000101110110001011111100101000010001010',
               '1110001110111101101100001010001110011101011111101010110011000000')
          == '1101010101011101110011000000111100111100100100011001011000001011101001100011011011010100110100010110101100000011010100000100111100111111100001110100000100100111100011111011000110101010000101110001110111101110011001000010001001001010010011000000111000011111')

    h1 = HMAC(key, msg_enc1)
    h2 = HMAC(key, msg_enc2)

    if (h1 == hmac):
        print("msg1 jest poprawna")

    if (h2 == hmac):
        print("msg2 jest poprawna")
