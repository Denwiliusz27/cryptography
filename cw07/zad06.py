def dec2bin(dec_str):
    return bin(dec_str).replace("0b", "")

# szybkie potęgowanie modulo
def pow_mod(x, n, m):
    p = 1

    # zamieniam n na zapis bitowy
    n_b = dec2bin(n)

    # pętla po wszystkich bitach
    for i in range(len(n_b)):
        # ustawiam p jako p^2 mod m
        p = (p ** 2) % m

        # jeśli sprawdzany bit jest == 1
        if n_b[i] == '1':
            # # ustawiam p = x^n mod m
            p = (p * x) % m

    return p


def enc(x,e,n):
    # wykonuje potęgowanie modulo
    return pow_mod(x, e, n)


def dec(y,d,n):
    # wykonuje potęgowanie modulo
    return pow_mod(y, d, n)


if __name__ == '__main__':
    n = 643341411543391711051425916925550311012265711300705520200325675109446836493100912341600261266222036750541155307483726185012838542757173209246878527615686866322037404779287199511097525538499079836420404197380885254900993985365780000028685663116338197119892656788379026665075201747282243427197060237417498419483
    e=208350389615113762788111263490297665109355377830736643503856528470357220208290606069461253441671763980314762012190291145414733535673548961910772961435143582756267132618995046438684186252163655289035228721360753675271711075033036291412267917936062230585687839901652792581357105686274730618278123193067279319927
    d = 502029145905912565237092248595126620632487653124329465045136187249992350554283419049087834111437813928483679744364041267436534897197233494007405790027156754593648940515350675746678776751088177077690779849077150675864299782170211270887279535225267271652686426692746042361641530130191025648848746210219401813175

    print(enc(17, e,
              n) == 353230656531616665332116231509462661273082280099289165110086677972943261270362976411810450837847461343993316190457124231852161403281191913264230575248953060776390559207669288928802429515257729255854064666904850354451664771847425807841069296028397747015905377374208615536177338019721932982992946095124218548486)
    print(dec(
        581228535329363957060482357417595500042117791982900743030228020443422357943293873902079555506233253640573184749108783275472243891683169424548126947970217999010556081853170166407244862004725833809785262442186726634369847615830487904940967188707443976155835347542897227831115870912021598488639913865347475436893,
        d, n) == 27)
    print(dec(enc(12, e, n), d, n) == 12)